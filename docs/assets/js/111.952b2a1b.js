(window.webpackJsonp=window.webpackJsonp||[]).push([[111],{645:function(e,t,s){"use strict";s.r(t);var a=s(13),o=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"securing-your-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#securing-your-node"}},[e._v("#")]),e._v(" Securing your Node")]),e._v(" "),s("p",[e._v("The goal of this guide is to walk you through steps you can take to secure your node against malicious actors.\nIt will describe both "),s("strong",[e._v("essential")]),e._v(" actions, which you "),s("strong",[e._v("must")]),e._v(" take, and "),s("strong",[e._v("nice-to-have")]),e._v(" actions, which are helpful but not required.")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("This guide is meant to be an "),s("strong",[e._v("introduction")]),e._v(" to some of the things you can do to harden your node machine.\nIf you are comfortable with the command-line terminal and want to go even further in protecting your node, take a look at the popular "),s("a",{attrs:{href:"https://github.com/imthenachoman/How-To-Secure-A-Linux-Server",target:"_blank",rel:"noopener noreferrer"}},[e._v("imthenachoman/How-To-Secure-A-Linux-Server"),s("OutboundLink")],1),e._v(" guide.")])]),e._v(" "),s("h2",{attrs:{id:"assumptions-in-this-guide"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#assumptions-in-this-guide"}},[e._v("#")]),e._v(" Assumptions in This Guide")]),e._v(" "),s("p",[e._v("This guide assumes your node runs "),s("code",[e._v("Ubuntu 20.04 LTS")]),e._v(".\nThe concepts will carry over to other systems but the example commands may not.")]),e._v(" "),s("p",[e._v("As with all of the commands in this guide, we assume that you are connecting "),s("strong",[e._v("remotely")]),e._v(" to your node's command terminal using "),s("code",[e._v("ssh")]),e._v(".\nIf you need a refresher on how to use "),s("code",[e._v("ssh")]),e._v(", take a look at the "),s("RouterLink",{attrs:{to:"/guides/node/ssh.html"}},[e._v("Intro to Secure Shell")]),e._v(" guide first.")],1),e._v(" "),s("h2",{attrs:{id:"essential-keep-your-client-machine-secure"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#essential-keep-your-client-machine-secure"}},[e._v("#")]),e._v(" ESSENTIAL: Keep your Client Machine Secure")]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("If you use your Smartnode locally (by physically logging into it with a keyboard and monitor directly attached to it), then "),s("strong",[e._v("this section is not relevant to you - you can skip it")]),e._v(".")])]),e._v(" "),s("p",[e._v("Most Smartnode operators interact with their node remotely by connecting to its terminal from another computer using "),s("code",[e._v("ssh")]),e._v(":")]),e._v(" "),s("ul",[s("li",[e._v("The machine you connect "),s("em",[e._v("to")]),e._v(" (in this case, your node machine) is called the "),s("strong",[e._v("server")]),e._v(".")]),e._v(" "),s("li",[e._v("The machine you connect "),s("em",[e._v("from")]),e._v(" (such as your laptop, desktop, or even your phone) is the "),s("strong",[e._v("client")]),e._v(".")])]),e._v(" "),s("p",[e._v("One of the most important things you can do to secure your Smartnode is to "),s("strong",[e._v("keep your client machine secure")]),e._v(".\nIf your client machine is compromised and you use it to log into your node, then most of the security settings you apply to the node can be bypassed.")]),e._v(" "),s("p",[e._v("For example: if you use a laptop as an SSH client, and it has a "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Keystroke_logging",target:"_blank",rel:"noopener noreferrer"}},[e._v("keylogger"),s("OutboundLink")],1),e._v(" installed, then any secret things you type on the node (such as your password or recovery mnemonic) when connected via SSH will be stolen.")]),e._v(" "),s("p",[e._v("There is no definitive guide to keeping your client machine secure, but being aware that it is a factor in your security is a good first step.\nMake sure that your client machine is as secure as it can be.")]),e._v(" "),s("p",[e._v("Here are a few tips:")]),e._v(" "),s("ul",[s("li",[e._v("Don't use your client machine for "),s("strong",[e._v("risky activities")]),e._v(" (such as visiting untrustworthy websites or installing unnecessary programs)")]),e._v(" "),s("li",[e._v("Keep your client machine updated with the "),s("strong",[e._v("latest security patches")])]),e._v(" "),s("li",[e._v("If possible, use a "),s("strong",[e._v("malware and antivirus protection")]),e._v(" program for your Operating System")])]),e._v(" "),s("p",[e._v("For maximum security, you may want to use a "),s("strong",[e._v("dedicated machine")]),e._v(" as your SSH client, though this may not be practical for you.")]),e._v(" "),s("h2",{attrs:{id:"essential-secure-your-ssh-access"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#essential-secure-your-ssh-access"}},[e._v("#")]),e._v(" ESSENTIAL: Secure your SSH Access")]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("If you use your Smartnode locally (by physically logging into it with a keyboard and monitor directly attached to it), then "),s("strong",[e._v("this section is not relevant to you - you can skip it")]),e._v(".")])]),e._v(" "),s("p",[e._v("Whether you run your Smartnode at home or you use a VPS in a remote datacenter, it is likely that either you access it through SSH, or that SSH is enabled "),s("strong",[e._v("even if you do not use it")]),e._v(".")]),e._v(" "),s("p",[e._v("SSH connections are based on secure cryptography, but as with any secure system, the real security comes from using it correctly.\nThere are two main things to do for your SSH settings:")]),e._v(" "),s("ol",[s("li",[e._v("Use an SSH key to log in remotely instead of a username and password")]),e._v(" "),s("li",[e._v("Disable password-based authentication entirely, so SSH keys are the only remote login option")])]),e._v(" "),s("p",[e._v('As you are probably familiar with now, the default way to log into your node via SSH is with a username and password.\nThe downside of this is that your password is typically something rather "short" and susceptible to '),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Brute-force_attack",target:"_blank",rel:"noopener noreferrer"}},[e._v("brute-force attacks"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("Luckily, there is an alternative way to log in via SSH: an "),s("strong",[e._v("SSH key pair")]),e._v(".")]),e._v(" "),s("p",[e._v("SSH key pairs work similarly to blockchain wallets; they come with a public part (such as your wallet address) and a private part (the private key for your wallet address):")]),e._v(" "),s("ul",[s("li",[e._v("You provide the "),s("strong",[e._v("public part")]),e._v(" to your node. This way, the node knows you're allowed to connect to it, and it knows that it's really you trying to connect.")]),e._v(" "),s("li",[e._v("You keep the "),s("strong",[e._v("private part")]),e._v(" to yourself on your client machine. This way, you (and only you) can connect to your node.\n"),s("ul",[s("li",[e._v("You can (and should!) protect the private part with a "),s("strong",[e._v("password")]),e._v(", so someone who steals your key can't use it.")])])]),e._v(" "),s("li",[e._v("From a computer's perspective, the private key is "),s("strong",[e._v("exponentially harder")]),e._v(" to crack than a password is. This mitigates the risk of a brute-force attack against your node.")])]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("If you'd like to learn more about SSH key pairs before creating your own, take a look at these links:")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://canvas.cse.taylor.edu/courses/27/pages/ssh-key-tutorial",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://canvas.cse.taylor.edu/courses/27/pages/ssh-key-tutorial"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://www.ssh.com/academy/ssh/host-key",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://www.ssh.com/academy/ssh/host-key"),s("OutboundLink")],1)])])]),e._v(" "),s("h3",{attrs:{id:"creating-an-ssh-key-pair"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-an-ssh-key-pair"}},[e._v("#")]),e._v(" Creating an SSH Key Pair")]),e._v(" "),s("p",[e._v("Let's start by creating a new SSH key pair "),s("strong",[e._v("on your client machine")]),e._v(".\nThere are many varieties of key out there, but we're going to use a key type called "),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/EdDSA#Ed25519",target:"_blank",rel:"noopener noreferrer"}},[e._v("ed25519"),s("OutboundLink")],1),e._v(" which provides excellent security.")]),e._v(" "),s("p",[e._v("Run the following command "),s("strong",[e._v("on your client machine")]),e._v(" (i.e., you should "),s("strong",[e._v("not")]),e._v(" run this while already SSH'd into your node machine - if you are, "),s("strong",[e._v("exit out of SSH first")]),e._v("):")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ssh-keygen -t ed25519 -C "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"your_email@example.com"')]),e._v("\n")])])]),s("p",[e._v("You will see the following:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Generating public/private ed25519 key pair.\nEnter file in which to save the key (~/username/.ssh/id_ed25519):\n")])])]),s("p",[e._v("This asks you where you would like to save your private key file.\nSSH is compatible with the provided default and will automatically use it for you if you select it.\nHowever, you have the option of changing it to something else if you wish.")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("The path "),s("code",[e._v("~/username/.ssh/id_ed25519")]),e._v(" is just an example, assuming your username is "),s("code",[e._v("username")]),e._v(".\nYou likely have a different username.\nWhenever you see a path like the above in this guide, replace it with whatever path your system actually prints with your actual username.")])]),e._v(" "),s("p",[e._v("If you are comfortable with the default setting, simply press "),s("code",[e._v("Enter")]),e._v(".")]),e._v(" "),s("p",[e._v("Otherwise, type your desired location for the key.\nIt must be an absolute path (e.g. "),s("code",[e._v("~/username/.ssh/rocketpool_key")]),e._v(").\nPress "),s("code",[e._v("Enter")]),e._v(" when you're done.")]),e._v(" "),s("p",[e._v("After pressing "),s("code",[e._v("Enter")]),e._v(", you will see:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Enter passphrase (empty for no passphrase):\n")])])]),s("p",[s("strong",[e._v("This will become the password for the private key itself")]),e._v(".\nWhenever you use the key to connect to your node, you will need to enter this password first.")]),e._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[s("strong",[e._v("You should not leave this blank")]),e._v(" - otherwise, anyone with the SSH key file will be able to use it!\nPick a good password that you (and only you) will know.")]),e._v(" "),s("p",[e._v("Also, "),s("strong",[e._v("don't forget your password")]),e._v(" - there is no way to recover this password if you lose it.")])]),e._v(" "),s("p",[e._v("Once you finish typing the password, press "),s("code",[e._v("Enter")]),e._v(".\nIt will ask you to retype it for confirmation.")]),e._v(" "),s("p",[e._v("After that, you will see something like the following output:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Your identification has been saved in ~/username/.ssh/id_ed25519\nYour public key has been saved in ~/username/.ssh/id_ed25519.pub\nThe key fingerprint is:\nSHA256:CASbPZETiQ83lLhpUO2aoT05TxMVLwqiWtdsRtoPt4s your_email@example.com\nThe key's randomart image is:\n+--[ED25519 256]--+\n| .o*==..         |\n|. +=O...         |\n|..+B++o .        |\n|..=.+X o         |\n|.+.=+.O S        |\n|o.B.oo + .       |\n|.  = .  o        |\n|    .  . .       |\n|      E .        |\n+----[SHA256]-----+\n")])])]),s("p",[e._v("The first line states the location of the "),s("strong",[e._v("private key")]),e._v(", which is called "),s("code",[e._v("id_ed25519")]),e._v(" by default (notice that it does not have a file extension).\nUbuntu will load this key for you automatically when you use "),s("code",[e._v("ssh")]),e._v(" if this private key file is in the default location.")]),e._v(" "),s("p",[e._v("The second line states the location of the "),s("strong",[e._v("public key")]),e._v(", which is called "),s("code",[e._v("id_ed25519.pub")]),e._v(" by default.\nWe'll need the public key for the next step.")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("Ubuntu "),s("em",[e._v("should")]),e._v(" load this new key automatically.\nHowever, some systems (such as macOS machines) will not load it automatically - you will have to tell it to do this with the following command "),s("strong",[e._v("on your client machine")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ssh-add ~/username/.ssh/id_ed25519\n")])])]),s("p",[e._v("Note that this is the path of the "),s("strong",[e._v("private key")]),e._v(" that we generated in the previous step, "),s("strong",[e._v("not the public key")]),e._v(".\nReplace the path with whatever your system printed in that previous step.")]),e._v(" "),s("p",[e._v("If you get an error saying that the "),s("code",[e._v("ssh-agent")]),e._v(" is not running, start it by running the following command "),s("strong",[e._v("on your client machine")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("eval")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("ssh-agent"),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("\n")])])]),s("p",[e._v("If you don't want to type these two commands every time you open the terminal, you can create a shortcut for adding your key by adding an "),s("code",[e._v("alias")]),e._v(" to your "),s("code",[e._v("~/.bashrc")]),e._v(" file.")]),e._v(" "),s("p",[e._v("Open the file using the text editor:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" ~/.bashrc\n")])])]),s("p",[e._v("Add this line to the end (assuming you used the default path for the private key - update as necessary):")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("alias loadkey='ssh-add $HOME/.ssh/id_ed25519'\n")])])]),s("p",[e._v("Save and exit with "),s("code",[e._v("Ctrl+O")]),e._v(" and "),s("code",[e._v("Enter")]),e._v(", then "),s("code",[e._v("Ctrl+X")]),e._v(".\nNext, close and open your terminal for the changes to take effect.")]),e._v(" "),s("p",[e._v("You can now type "),s("code",[e._v("loadkey")]),e._v(" "),s("strong",[e._v("on your client machine")]),e._v(" to load the key.")])]),e._v(" "),s("h3",{attrs:{id:"adding-the-public-key-to-your-node"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-the-public-key-to-your-node"}},[e._v("#")]),e._v(" Adding the Public Key to your Node")]),e._v(" "),s("p",[e._v("Once you have your SSH key pair, you can now add the "),s("strong",[e._v("public key")]),e._v(" to your node.\nThis will let you connect to it over "),s("code",[e._v("ssh")]),e._v(" using the private key you just generated, instead of your username and password.")]),e._v(" "),s("p",[e._v("There are two ways to do this - if one doesn't work, try the other way:")]),e._v(" "),s("Tabs",{attrs:{type:"border-card"}},[s("Tab",{attrs:{label:"Using ssh-copy-id"}},[s("p",[s("strong",[e._v("Note")]),e._v(": if your client machine is running Windows, "),s("code",[e._v("ssh-copy-id")]),e._v(' is not yet available.\nPlease follow the instructions in the "Manually Adding the Key" tab.')]),e._v(" "),s("p",[e._v("Run the following command "),s("strong",[e._v("on your client machine")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ssh-copy-id -i ~/username/.ssh/id_ed25519.pub username@node.ip.address\n")])])]),s("p",[e._v("For example, if my username on the node was "),s("code",[e._v("staker")]),e._v(" and my node's IP address was "),s("code",[e._v("192.168.1.10")]),e._v(", I would run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("ssh-copy-id -i ~/staker/.ssh/id_ed25519.pub staker@192.168.1.10\n")])])]),s("p",[e._v("You will see some messages like the following:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "~/username/.ssh/id_ed25519.pub"\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys\n')])])]),s("p",[e._v("This tells you that it's trying to log in with your key first to make sure it isn't already there.\nOnce it fails logging in, it knows that it's OK to add the new public key to the node machine.")]),e._v(" "),s("p",[e._v("It will then prompt you for the "),s("strong",[e._v("password of the user on your node machine")]),e._v(".\n("),s("em",[e._v("Note that this is "),s("strong",[e._v("not the password of the SSH key")]),e._v("!")]),e._v(")")]),e._v(" "),s("p",[e._v("Enter your user's password, and you will see the following output:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Number of key(s) added: 1\n\nNow try logging into the machine with:   \"ssh 'username@node.ip.address'\"\nand check to make sure that only the key(s) you wanted were added.\n")])])]),s("p",[e._v("That means it worked!")])]),e._v(" "),s("Tab",{attrs:{label:"Manually Adding the Key"}},[s("p",[e._v("Start by getting the contents of the "),s("strong",[e._v("public key")]),e._v(" - run this command "),s("strong",[e._v("on your client machine")]),e._v(":")]),e._v(" "),s("ul",[s("li",[e._v("On macOS and Linux:")])]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("cat")]),e._v(" ~/.ssh/id_ed25519.pub\n")])])]),s("ul",[s("li",[e._v("On Windows (Command Prompt):")])]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("type")]),e._v(" %USERPROFILE%"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v(".ssh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("id_ed25519.pub\n")])])]),s("ul",[s("li",[e._v("On Windows (PowerShell):")])]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("type")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$ENV")]),e._v(":UserProfile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v(".ssh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("id_ed25519.pub\n")])])]),s("p",[e._v("The output will look something like this:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGUgU3a6mNjy3N1TyWOwY+VA/nifAeABl2Ch2yIl1bGa your_email@example.com\n")])])]),s("p",[e._v("This is your "),s("strong",[e._v("public key")]),e._v(".\nCopy this output and store it somewhere convenient - you're going to need it in a minute.")]),e._v(" "),s("p",[e._v("Next, use "),s("code",[e._v("ssh")]),e._v(" to connect to your node like you normally would (using your node's username and password).")]),e._v(" "),s("p",[e._v("Once you're connected to your node, run the following command:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" ~/.ssh/authorized_keys\n")])])]),s("p",[e._v("This will open a text editor for the file used to store all of the public keys that your node's user account trusts.")]),e._v(" "),s("p",[e._v("In this file, paste the "),s("strong",[e._v("public key")]),e._v(" that you retrieved a few steps ago using the "),s("code",[e._v("cat")]),e._v(" command (the whole line starting with "),s("code",[e._v("ssh-ed25519")]),e._v(").")]),e._v(" "),s("p",[e._v("When it's in, save the file with "),s("code",[e._v("Ctrl+O")]),e._v(" and "),s("code",[e._v("Enter")]),e._v(", then press "),s("code",[e._v("Ctrl+X")]),e._v(" to exit.")]),e._v(" "),s("p",[e._v("Now, exit "),s("code",[e._v("ssh")]),e._v(" by running the "),s("code",[e._v("exit")]),e._v(" command so you return back to your local client machine's terminal.")])])],1),e._v(" "),s("p",[e._v("You should now be able to "),s("code",[e._v("ssh")]),e._v(" into the node like you normally would, but now you won't have to type the password of the user account.")]),e._v(" "),s("p",[e._v("Instead, you will have to type "),s("strong",[e._v("the password of your SSH private key")]),e._v(".\nDepending on your system settings, you may only have to do this once per restart, or you may have to do it every time you use the key to connect to your node.")]),e._v(" "),s("h3",{attrs:{id:"disable-login-via-password"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#disable-login-via-password"}},[e._v("#")]),e._v(" Disable Login-via-Password")]),e._v(" "),s("p",[e._v("Even though you have an SSH key pair set up, your node will still allow other machines to try to log in using the username and password method.\nThis defeats the entire purpose of using SSH keys in the first place, so the next step is to disable those.")]),e._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("You are about to modify the SSH server's configuration.\nAll of your "),s("strong",[e._v("existing")]),e._v(" SSH sessions will be preserved.\nHowever, if you make a mistake, then it's possible that you will not be able to create "),s("strong",[e._v("new")]),e._v(" SSH sessions anymore and effectively lock yourself out of the machine.")]),e._v(" "),s("p",[e._v("To prevent this, we strongly recommend that you create "),s("strong",[e._v("2 SSH sessions")]),e._v(" for the next steps - one for editing things and testing, and one as a backup so you can revert any breaking changes.")])]),e._v(" "),s("p",[e._v("Start by logging into your machine using "),s("code",[e._v("ssh")]),e._v(" as usual:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("ssh")]),e._v(" user@your.node.ip.address\n")])])]),s("p",[e._v("As a reminder, "),s("strong",[e._v("you should do this twice on two separate terminals so you have a backup session just in case")]),e._v(".\nYou can ignore the backup session for now - we'll tell you when you need it.\nRun the following commands "),s("strong",[e._v("only in the first session")]),e._v(".")]),e._v(" "),s("p",[e._v("Open the configuration file for the SSH server:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/ssh/sshd_config\n")])])]),s("p",[e._v("As with all commands that start with "),s("code",[e._v("sudo")]),e._v(", this will prompt you for your "),s("strong",[e._v("user account's password")]),e._v(".\nThis is a large file, so you'll have to navigate through it using the arrow keys on your keyboard or "),s("code",[e._v("Page Up")]),e._v(" / "),s("code",[e._v("Page Down")]),e._v(".")]),e._v(" "),s("p",[e._v("Make the following changes:")]),e._v(" "),s("ol",[s("li",[e._v("Uncomment "),s("code",[e._v("#AuthorizedKeysFile")]),e._v(" if it is commented (by removing the "),s("code",[e._v("#")]),e._v(" in front of it)")]),e._v(" "),s("li",[e._v("Change "),s("code",[e._v("ChallengeResponseAuthentication yes")]),e._v(" to "),s("code",[e._v("ChallengeResponseAuthentication no")])]),e._v(" "),s("li",[e._v("Change "),s("code",[e._v("PasswordAuthentication yes")]),e._v(" to "),s("code",[e._v("PasswordAuthentication no")])]),e._v(" "),s("li",[e._v("Change "),s("code",[e._v("PermitRootLogin yes")]),e._v(" to "),s("code",[e._v("PermitRootLogin prohibit-password")]),e._v(" unless it's already set to that and has a "),s("code",[e._v("#")]),e._v(" in front of it")])]),e._v(" "),s("p",[e._v("Once you're done, save with "),s("code",[e._v("Ctrl+O")]),e._v(" and "),s("code",[e._v("Enter")]),e._v(", then exit with "),s("code",[e._v("Ctrl+X")]),e._v(".")]),e._v(" "),s("p",[e._v("Next, restart the SSH server so it picks up the new settings:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl restart sshd\n")])])]),s("p",[e._v("After this, logging into SSH via a username and password should be disabled.")]),e._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("At this point, you should exit the SSH session and try to SSH back in.\nIf you are able to do so successfully, then your SSH configuration is still valid!")]),e._v(" "),s("p",[e._v("If you are "),s("strong",[e._v("not")]),e._v(" able to get back in, then something has gone wrong with your configuration.\nUse the backup SSH session you created at the start of this section to modify the "),s("code",[e._v("/etc/ssh/sshd_config")]),e._v(" file.")]),e._v(" "),s("p",[e._v("Try to find the mistake or undo your changes, then restart the SSH server using "),s("code",[e._v("sudo systemctl restart sshd")]),e._v(".")]),e._v(" "),s("p",[e._v('Once it\'s been restarted, try connecting with SSH again on your "other" terminal.\nKeep doing this until you have it working again and are able to successfully connect.')])]),e._v(" "),s("h3",{attrs:{id:"optional-enable-two-factor-authentication"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#optional-enable-two-factor-authentication"}},[e._v("#")]),e._v(" (Optional) Enable Two-Factor Authentication")]),e._v(" "),s("p",[e._v("Two-factor authentication involves requiring a second security measure in addition to your password or SSH key, usually on a separate device from your primary one.")]),e._v(" "),s("p",[e._v("For example, you may be familiar with logging into a website such as a crypto exchange using both a password and a Google Authenticator code (or an SMS code).\nThis two-step process is an example of two-factor authentication.")]),e._v(" "),s("p",[e._v("SSH can also be configured to require a Google Authenticator code, which means that an attacker that somehow compromised your SSH key and its passphrase would "),s("strong",[e._v("still need the device with the authenticator app on it")]),e._v(" (presumably your phone).\nThis adds an extra layer of security to your system.")]),e._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[e._v("We "),s("strong",[e._v("strongly recommend")]),e._v(" that you open a second terminal with an SSH connection to your node, just in case you misconfigure something.\nThis way, you will have a backup that is still connected in case you lock yourself out, so you can easily undo your mistakes.")]),e._v(" "),s("p",[e._v("If you "),s("strong",[e._v("do")]),e._v(" manage to lock yourself out, you will need to physically access your node via its local monitor and keyboard to log in and repair the misconfiguration.")])]),e._v(" "),s("p",[e._v("Start by installing "),s("a",{attrs:{href:"https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en_US&gl=US",target:"_blank",rel:"noopener noreferrer"}},[e._v("Google Authenticator"),s("OutboundLink")],1),e._v(" (or a compatible equivalent) on your phone if you don't already have it.\nFor Android users, consider "),s("a",{attrs:{href:"https://play.google.com/store/apps/details?id=org.shadowice.flocke.andotp&hl=en_US&gl=US",target:"_blank",rel:"noopener noreferrer"}},[e._v("andOTP"),s("OutboundLink")],1),e._v(" which is an open-source alternative that supports password locking and convenient backups.")]),e._v(" "),s("p",[e._v("Next, install the Google Authenticator module on your node with this command:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y libpam-google-authenticator\n")])])]),s("p",[e._v("Now tell the "),s("code",[e._v("PAM")]),e._v(" (pluggable authentication modules) to use this module.\nFirst, open the config file:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/pam.d/sshd\n")])])]),s("p",[e._v("Find "),s("code",[e._v("@include common-auth")]),e._v(" (it should be at the top) and comment it out by adding a "),s("code",[e._v("#")]),e._v(" in front of it, so it looks like this:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# Standard Un*x authentication.\n#@include common-auth\n")])])]),s("p",[e._v("Next, add these lines to the top of the file:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Enable Google Authenticator")]),e._v("\nauth required pam_google_authenticator.so\n")])])]),s("p",[e._v("Then save and exit the file with "),s("code",[e._v("Ctrl+O")]),e._v(", "),s("code",[e._v("Enter")]),e._v(", and "),s("code",[e._v("Ctrl+X")]),e._v(".")]),e._v(" "),s("p",[e._v("Now that "),s("code",[e._v("PAM")]),e._v(" knows to use Google Authenticator, the next step is to tell "),s("code",[e._v("sshd")]),e._v(" to use "),s("code",[e._v("PAM")]),e._v(".\nOpen the "),s("code",[e._v("sshd")]),e._v(" config file:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/ssh/sshd_config\n")])])]),s("p",[e._v("Now change the line "),s("code",[e._v("ChallengeResponseAuthentication no")]),e._v(" to "),s("code",[e._v("ChallengeResponseAuthentication yes")]),e._v(" so it looks like this:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("# Change to yes to enable challenge-response passwords (beware issues with\n# some PAM modules and threads)\nChallengeResponseAuthentication yes\n")])])]),s("p",[e._v("Add the following line to the bottom of the file, which indicates to "),s("code",[e._v("sshd")]),e._v(" that it needs both an SSH key and the Google Authenticator code:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("AuthenticationMethods publickey,keyboard-interactive\n")])])]),s("p",[e._v("Then save and exit the file with "),s("code",[e._v("Ctrl+O")]),e._v(", "),s("code",[e._v("Enter")]),e._v(", and "),s("code",[e._v("Ctrl+X")]),e._v(".")]),e._v(" "),s("p",[e._v("Now that "),s("code",[e._v("sshd")]),e._v(" is set up, we need to create our 2FA codes.\nIn your terminal, run:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("google-authenticator\n")])])]),s("p",[e._v("First, it will ask you about time-based tokens.\nSay "),s("code",[e._v("y")]),e._v(" to this question:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Do you want authentication tokens to be time-based: y\n")])])]),s("p",[e._v("You will now see a big QR code on your screen; scan it with your Google Authenticator app to add it.\nYou will also see your secret and a few backup codes looking like this:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Your new secret key is: IRG2TALMR5U2LK5VQ5AQIG3HA4\nYour verification code is 282436\nYour emergency scratch codes are:\n  29778030\n  86888537\n  50553659\n  41403052\n  82649596\n")])])]),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("Record the emergency scratch codes somewhere safe in case you need to log into the machine but don't have your 2FA app handy.\nWithout the app, you will no longer be able to SSH into the machine!")])]),e._v(" "),s("p",[e._v("Finally, it will ask you for some more parameters; the recommended defaults are as follows:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('Do you want me to update your "/<username>/.google_authenticator" file: y\nDo you want to disallow multiple uses of the same authentication token: y\nBy default... < long story about time skew > ... Do you want to do so: n\nDo you want to enable rate-limiting: y\n')])])]),s("p",[e._v("Once you're done, restart "),s("code",[e._v("sshd")]),e._v(" so it grabs the new settings:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl restart sshd\n")])])]),s("p",[e._v("When you try to SSH into your server with your SSH keys, you should now also be asked for a 2FA verification code, but not for a password.")]),e._v(" "),s("h2",{attrs:{id:"essential-enable-automatic-security-updates"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#essential-enable-automatic-security-updates"}},[e._v("#")]),e._v(" ESSENTIAL: Enable Automatic Security Updates")]),e._v(" "),s("p",[e._v("Operating System vendors routinely publish updates and security fixes, so it is important that you keep your system up to date with the latest patches.\nThe easiest way to do this is to enable automatic updates.")]),e._v(" "),s("p",[e._v("Run the following commands "),s("strong",[e._v("on your node machine")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" update\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y unattended-upgrades update-notifier-common\n")])])]),s("p",[e._v("You can change the auto-update settings by editing "),s("code",[e._v("/etc/apt/apt.conf.d/20auto-upgrades")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/apt/apt.conf.d/20auto-upgrades\n")])])]),s("p",[e._v("This is an example of reasonable auto-update settings:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[e._v("APT::Periodic::Update-Package-Lists "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nAPT::Periodic::Unattended-Upgrade "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nAPT::Periodic::AutocleanInterval "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"7"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nUnattended-Upgrade::Remove-Unused-Dependencies "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nUnattended-Upgrade::Remove-New-Unused-Dependencies "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# This is the most important choice: auto-reboot.")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# This should be fine since Rocketpool auto-starts on reboot.")]),e._v("\nUnattended-Upgrade::Automatic-Reboot "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\nUnattended-Upgrade::Automatic-Reboot-Time "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"02:00"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),s("p",[e._v("When you are done adding your changes, save with "),s("code",[e._v("Ctrl+O")]),e._v(" and "),s("code",[e._v("Enter")]),e._v(", then exit with "),s("code",[e._v("Ctrl+X")]),e._v(".")]),e._v(" "),s("p",[e._v("After, make sure to load the new settings:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl restart unattended-upgrades\n")])])]),s("h2",{attrs:{id:"essential-enable-a-firewall"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#essential-enable-a-firewall"}},[e._v("#")]),e._v(" ESSENTIAL: Enable a Firewall")]),e._v(" "),s("p",[e._v("In general, your machine should only accept network traffic on ports that your Execution (ETH1) client, Consensus (ETH2) client, and Smartnode stack use.\nTo enforce that and prevent any unexpected or undesirable traffic, we can install a "),s("strong",[e._v("firewall")]),e._v(" on the node.")]),e._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[e._v("If you selected a different execution/consensus client port during the Rocketpool setup, you need to edit the ports below to reflect your settings.")])]),e._v(" "),s("p",[e._v("Ubuntu comes with "),s("code",[e._v("ufw")]),e._v(" installed by default (the "),s("strong",[e._v("u")]),e._v("ncomplicated "),s("strong",[e._v("f")]),e._v("ire "),s("strong",[e._v("w")]),e._v("all), which is a convenient utility for managing your node's firewall settings.")]),e._v(" "),s("p",[e._v("The following commands will set "),s("code",[e._v("ufw")]),e._v(" up with a good default configuration for your Smartnode.\n"),s("strong",[e._v("Run these on your node machine")]),e._v(".")]),e._v(" "),s("p",[e._v("Disable connections unless they're explicitly allowed by later rules:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ufw default deny incoming comment "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Deny all incoming traffic'")]),e._v("\n")])])]),s("p",[e._v("Allow SSH:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ufw allow "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"22/tcp"')]),e._v(" comment "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Allow SSH'")]),e._v("\n")])])]),s("p",[e._v("Allow execution client (formerly referred to as ETH1):")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ufw allow "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("30303")]),e._v("/tcp comment "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Execution client port, standardized by Rocket Pool'")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ufw allow "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("30303")]),e._v("/udp comment "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Execution client port, standardized by Rocket Pool'")]),e._v("\n")])])]),s("p",[e._v("Allow consensus client (formerly referred to as ETH2):")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ufw allow "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("9001")]),e._v("/tcp comment "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Consensus client port, standardized by Rocket Pool'")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ufw allow "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("9001")]),e._v("/udp comment "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'Consensus client port, standardized by Rocket Pool'")]),e._v("\n")])])]),s("p",[e._v("Finally, enable "),s("code",[e._v("ufw")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo ufw enable\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[s("code",[e._v("iptables")]),e._v(" experts might note that Docker bypasses "),s("code",[e._v("ufw")]),e._v(" settings.\nStrictly speaking, that means unless you are running in Hybrid mode, you do not need the Execution and Consensus client rules.\nAdding them, however, has no downside and will make sure that if you ever switch to Hybrid mode you will not run into firewall issues.")])]),e._v(" "),s("h2",{attrs:{id:"optional-enable-brute-force-and-ddos-protection"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#optional-enable-brute-force-and-ddos-protection"}},[e._v("#")]),e._v(" (Optional) Enable Brute-Force and DDoS Protection")]),e._v(" "),s("p",[e._v("To protect your server from DDoS attacks and brute-force connection attempts, you can install "),s("code",[e._v("fail2ban")]),e._v(".\nThis program will monitor incoming connections and block IP addresses that try to log in with faulty credentials repeatedly.")]),e._v(" "),s("p",[e._v("See "),s("a",{attrs:{href:"https://github.com/imthenachoman/How-To-Secure-A-Linux-Server#application-intrusion-detection-and-prevention-with-fail2ban",target:"_blank",rel:"noopener noreferrer"}},[e._v("this guide"),s("OutboundLink")],1),e._v(" for more information on intrusion prevention.")]),e._v(" "),s("p",[e._v("Run the following commands "),s("strong",[e._v("on your node machine")]),e._v(":")]),e._v(" "),s("p",[e._v("Install the service:")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" -y fail2ban\n")])])]),s("p",[e._v("Next, open "),s("code",[e._v("/etc/fail2ban/jail.d/ssh.local")]),e._v(":")]),e._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/fail2ban/jail.d/ssh.local\n")])])]),s("p",[e._v("Add the following contents to it:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("[sshd]\nenabled = true\nbanaction = ufw\nport = 22\nfilter = sshd\nlogpath = %(sshd_log)s\nmaxretry = 5\n")])])]),s("p",[e._v("You can change the "),s("code",[e._v("maxretry")]),e._v(" setting, which is the number of attempts it will allow before locking the offending address out.")]),e._v(" "),s("p",[e._v("Once you're done, save and exit with "),s("code",[e._v("Ctrl+O")]),e._v(" and "),s("code",[e._v("Enter")]),e._v(", then "),s("code",[e._v("Ctrl+X")]),e._v(".")]),e._v(" "),s("p",[e._v("Finally, restart the service:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo systemctl restart fail2ban\n")])])]),s("p",[e._v("And with that, you've just greatly improved the security posture of your node.\nCongratulations!")])],1)}),[],!1,null,null,null);t.default=o.exports}}]);