(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{641:function(e,t,n){"use strict";n.r(t);var o=n(13),a=Object(o.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"pruning-the-execution-client"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pruning-the-execution-client"}},[e._v("#")]),e._v(" Pruning the Execution Client")]),e._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),n("p",[e._v("This is meant for "),n("code",[e._v("geth")]),e._v(" and "),n("code",[e._v("nethermind")]),e._v(" users.\nBesu does "),n("em",[e._v("not")]),e._v(" need to be pruned.")])]),e._v(" "),n("p",[e._v("If you use "),n("code",[e._v("geth")]),e._v(" or "),n("code",[e._v("nethermind")]),e._v(" as your primary Execution (ETH1) client, you will likely notice that your node's free disk space slowly decreases over time.\nThe Execution client is by far the biggest contributor to this; depending on how much RAM you allocated to its cache during "),n("code",[e._v("rocketpool service config")]),e._v(", it can grow at a rate of several gigabytes per day!")]),e._v(" "),n("p",[e._v("To handle this, Execution clients provide a special function called "),n("strong",[e._v("pruning")]),e._v(" that lets them scan and clean up their database safely to reclaim some free space.\nEvery node operator using Geth or Nethermind will have to prune it eventually.")]),e._v(" "),n("p",[e._v("If you have a 2 TB SSD, you can usually go for months between rounds of pruning.\nFor 1 TB SSD users, you will have to prune more frequently.")]),e._v(" "),n("p",[e._v("If you have "),n("RouterLink",{attrs:{to:"/guides/node/grafana.html"}},[e._v("the Grafana dashboard")]),e._v(" enabled, a good rule of thumb is to start thinking about pruning your Execution client when your node's used disk space exceeds 80%.")],1),e._v(" "),n("p",[e._v("When you decide that it's time, the Smartnode comes with the ability to prune it for you upon request.\nRead below to learn how it works, and what to expect.")]),e._v(" "),n("div",{staticClass:"custom-block warning"},[n("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),n("p",[e._v("Pruning your Execution client is only possible in Docker Mode.")]),e._v(" "),n("p",[e._v("If you use your own Execution (ETH1) client, such as an external client in Hybrid mode or Native mode, you cannot use the Smartnode to prune the Execution client.\nYou will need to do it manually.\nPlease refer to the documentation for your Execution client to learn how to prune it.")])]),e._v(" "),n("h2",{attrs:{id:"prerequisites"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),n("p",[e._v("Select the client you're using from the tabs below.")]),e._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"Geth"}},[n("p",[e._v("Pruning Geth means taking the primary Execution (ETH1) client offline so it can clean itself up.\nWhen this happens, the Smartnode (and your Consensus (ETH2) client) will need some other way to access the ETH1 chain in order to function properly.")]),e._v(" "),n("p",[e._v("The easiest way to provide this is with a "),n("strong",[e._v("fallback node")]),e._v(".\nIf you "),n("RouterLink",{attrs:{to:"/guides/node/fallback.html"}},[e._v("configured a fall back node")]),e._v(" using "),n("code",[e._v("rocketpool service config")]),e._v(" already, then the Smartnode will automatically switch over to it when your Geth container goes down for maintenance for you.\nIt will also inform your Consensus (ETH2) client to use the fallback as well.")],1),e._v(" "),n("div",{staticClass:"custom-block danger"},[n("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),n("p",[e._v("If you don't have a fallback node configured, your node will stop validating during the pruning process.\nIt will miss all attestations and block proposals until it's finished and has resynced with the network.\n"),n("strong",[e._v("You will leak ETH due to missed validations during this time!")])])]),e._v(" "),n("p",[e._v("With that in mind, the following two conditions are required to successfully prune Geth:")]),e._v(" "),n("ul",[n("li",[e._v("A working fallback node configured")]),e._v(" "),n("li",[e._v("At least "),n("strong",[e._v("50 GB")]),e._v(" of free space remaining on your SSD")])])]),e._v(" "),n("Tab",{attrs:{label:"Nethermind"}},[n("p",[e._v("Nethermind is able to stay online while it prunes, meaning you do not require a fallback node to continue attesting.\nNote, however, that pruning is "),n("strong",[e._v("an extremely resource-intesive task")]),e._v(" and you may see an increase in your attestations' inclusion distance and missed attestations during it.")]),e._v(" "),n("p",[e._v("Nethermind does not require any special prerequisites; you are able to prune it at any time.")])])],1),e._v(" "),n("h2",{attrs:{id:"starting-a-prune"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#starting-a-prune"}},[e._v("#")]),e._v(" Starting a Prune")]),e._v(" "),n("p",[e._v("Select the client you're using from the tabs below.")]),e._v(" "),n("Tabs",{attrs:{type:"border-card"}},[n("Tab",{attrs:{label:"Geth"}},[n("p",[e._v("When you want to prune Geth, simply run this command:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("rocketpool service prune-eth1\n")])])]),n("p",[e._v("If you do not have a fallback client pair enabled, you will receive the following warning:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("This will shut down your main execution client and prune its database, freeing up disk space.\nOnce pruning is complete, your execution client will restart automatically.\n\nYou do not have a fallback execution client configured.\nYour node will no longer be able to perform any validation duties (attesting or proposing blocks) until Geth is done pruning and has synced again.\nPlease configure a fallback client with `rocketpool service config` before running this.\nAre you sure you want to prune your main execution client? [y/n]\n")])])]),n("p",[e._v("If you do have one enabled, you will see the following prompt instead:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("This will shut down your main execution client and prune its database, freeing up disk space.\nOnce pruning is complete, your execution client will restart automatically.\n\nYou have fallback clients enabled. Rocket Pool (and your consensus client) will use that while the main client is pruning.\nAre you sure you want to prune your main execution client? [y/n]\n")])])]),n("p",[e._v("If you accept, you'll see a few details as the Smartnode prepares things; it should end with a success message:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Are you sure you want to prune your main ETH1 client? [y/n]\ny\n\nYour disk has 303 GiB free, which is enough to prune.\nStopping rocketpool_eth1...\nProvisioning pruning on volume rocketpool_eth1clientdata...\nRestarting rocketpool_eth1...\n\nDone! Your main ETH1 client is now pruning. You can follow its progress with `rocketpool service logs eth1`.\nOnce it's done, it will restart automatically and resume normal operation.\nNOTE: While pruning, you **cannot** interrupt the client (e.g. by restarting) or you risk corrupting the database!\nYou must let it run to completion!\n")])])]),n("p",[e._v("With that, Geth is now pruning and you're all set!\nYou can follow its progress with:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("rocketpool service logs eth1\n")])])]),n("p",[e._v("Once it's done pruning, it will restart automatically and the Smartnode will resume using it again instead of your fallback.")])]),e._v(" "),n("Tab",{attrs:{label:"Nethermind"}},[n("p",[e._v("When you want to prune Nethermind, simply run this command:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("rocketpool service prune-eth1\n")])])]),n("p",[e._v("You will see the following prompt:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("This will shut down your main execution client and prune its database, freeing up disk space.\nOnce pruning is complete, your execution client will restart automatically.\n\nAre you sure you want to prune your main execution client? [y/n]\n")])])]),n("p",[e._v("If you accept, you'll see a few messages similar to the following:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('Your disk has 790 GiB free, which is enough to prune.\nStopping rocketpool_eth1...\nProvisioning pruning on volume rocketpool_eth1clientdata...\nRestarting rocketpool_eth1...\nError requesting prune: AggregateException - One or more errors occurred. (Connection refused (127.0.0.1:7434))\nTrying again in 3 seconds... (1/100)\n...\nTrying again in 3 seconds... (10/100)\nSuccess: Pruning is now "Starting"\n\nDone! Your main execution client is now pruning. You can follow its progress with `rocketpool service logs eth1`.\nOnce it\'s done, it will restart automatically and resume normal operation.\nNOTE: While pruning, you **cannot** interrupt the client (e.g. by restarting) or you risk corrupting the database!\nYou must let it run to completion!\n')])])]),n("p",[e._v("With that, Nethermind is now pruning and you're all set!\nYou can follow its progress with:")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("rocketpool service logs eth1\n")])])]),n("p",[e._v("Once it's done pruning, it will restart automatically.")])])],1)],1)}),[],!1,null,null,null);t.default=a.exports}}]);